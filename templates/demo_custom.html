{% extends 'base.html' %}

{% block head %}

<script src="{{ url_for('static', filename='vendor/google/jsapi.js') }}"></script>
<!-- <script src="{{ url_for('static', filename='vendor/google/transliteration.I.js') }}"></script> -->

{% endblock %}

{% block content %}
<style>
::-webkit-file-upload-button {

  padding: 0.5em;
}


}
</style>

<div class="grid-x">
    <div class="cell" style="padding-bottom: 5px;">
      <center><h1 style="color: black">Wav2Lip: Accurately Lip-sync Videos to Any Speech</h1></center>
    </div>
    <div class="cell">
      <center>
        <ul>
          <li style="display: inline; font-size: 18px; color:black;"><a href="https://scholar.google.co.in/citations?user=C-wGb2sAAAAJ&hl=en">K R Prajwal*</a>,</li>
          <li style="display: inline; font-size: 18px; color:black;"><a href="https://scholar.google.com/citations?user=sbkDAPcAAAAJ&hl=en">Rudrabha Mukhopadhyay*</a>,</li>
          <li style="display: inline; font-size: 18px; color:black;"><a href="https://vinaypn.github.io/">Vinay P. Namboodiri</a>,</li>
          <li style="display: inline; font-size: 18px; color:black;"><a href="https://faculty.iiit.ac.in/~jawahar/index.html">C V Jawahar</a></li>
        </ul>
        <ul>
          <li style="display: inline; font-size: 18px"><a href="https://arxiv.org/abs/2008.10010" style="color: red;">[Paper]</a></li>
          <li style="display: inline; font-size: 18px"><a href="http://cvit.iiit.ac.in/research/projects/cvit-projects/a-lip-sync-expert-is-all-you-need-for-speech-to-lip-generation-in-the-wild" style="color: #996633">[Project Page]</a></li>
          <li style="display: inline; font-size: 18px"><a href="https://github.com/Rudrabha/Wav2Lip" style="color: green;">[Code]</a></li>
          <li style="display: inline; font-size: 18px"><a href="https://youtu.be/0fXaDCZNOJc" style="color: #ff00ff;">[Demo Video]</a></li>
        </ul>
      </center>
      <hr>
        <p style="text-align: justify; color: black">In our paper, <b><i>A Lip Sync Expert Is All You Need for Speech to Lip Generation In the Wild</i></b>, <i>ACM Multimedia 2020</i>, we aim to lip-sync unconstrained videos in the wild to any desired target speech. Current works excel at producing accurate lip movements on a static image or videos of specific people seen during the training phase. However, they fail to accurately morph the lip movements of arbitrary identities in dynamic, unconstrained talking face videos, resulting in significant parts of the video being out-of-sync with the new audio. We identify key reasons pertaining to this and resolve them by learning from a powerful lip-sync discriminator. Extensive quantitative evaluations on our challenging benchmarks show that the lip-sync accuracy of the videos generated by our Wav2Lip model is almost as good as real synced videos. Please check out our <a href="https://arxiv.org/abs/2008.10010">paper</a> for more details about the model and also our novel evaluation framework.</p>
        <hr>
        <!-- <a href="">[Paper]</a> <a href="https://github.com/Rudrabha/Wav2Lip">[Code]</a> <a href="">[Demo Video]</a></h4></center> -->
    </div>
</div>

<div class="grid-x grid-margin-x">
    <div class="cell large-4">
      <h3 style="color: black"><u>Interactive Demo</u></h3>
      <form action = "{{ url_for('upload_file') }}" method = "POST" 
         enctype = "multipart/form-data">
         <label for="file">Select a video file (Max 20 seconds):</label>
         <input type = "file" name = "file" id="vid_inp" />
         <label for="file1">Select an audio file (or) video with audio (Max 20 sec):</label>
         <input type = "file" name = "file1" id="aud_inp"/>
         <input type = "submit" value="Sync this pair" class="button"
            onclick="return submit_form(this);" />
      </form> 
      <h5 style="color: red;"><i>Or choose from the example pairs below!</i></h5>
    </div>
      <div>

      <video width="480" height="285" controls="" autoplay="" name="media">
        <source src={{ value }} type="video/mp4">
          Your browser does not support the video tag.
      </video>

    </div>
</div>
<hr>
<p style="color: red">Using our open-source <a href="https://github.com/Rudrabha/Wav2Lip">code</a>, you can attempt to lip-sync higher resolution/longer videos. You will be able to tune the inference parameters and hence obtain a much better result for the same inputs.</p>

<p style="font-size:15px; text-align: justify;">Note: If you do not get back a video result, it most likely means that the face detector could not detect faces in all the input video frames. This can sometimes happen for animated movie clips. It may take some time (not more than a minute usually) to generate the results! All results are currently limited to (utmost) 480p resolution and will be cropped to max. 20s to minimize compute latency. This interactive site is only an user-friendly demonstration of the bare minimum capabilities of the Wav2Lip model. </p>


<!-- <br> -->

<!-- <div class="grid-x">
    <div class="cell">
       This work is published in the following paper: <b>"A Lip Sync Expert Is All You Need for Speech to Lip Generation In the Wild"</b>, ACM Multimedia 2020 (Accepted)
    </div>
</div>
<br> -->
<div class="grid-x">
    <div class="cell">
        <h1 class="title">Examples you can instantly try:</h1>
    </div>
</div>
<table style="width:100%">
  <tr>
    <th>Unsynced Video Input</th>
    <th>Target Audio</th>
    <th>Submit</th>
  </tr>
  <tr>
    <td style="text-align:center;">
      <video controls="" name="media1" width="320" height="240">
        <source src="static/samples/dictator_orig.mp4" type="video/mp4">
      </video>
    </td>
    <td style="text-align:center;">
      <audio controls="" name="media2">
        <source src="static/samples/dictator_audio_extracted.wav" type="audio/mpeg">
      </audio>
    </td>
    <td style="text-align:center;">
      <form action = "{{ url_for('example_fetch1') }}" method = "POST" 
         enctype = "multipart/form-data">
         <input type = "submit"/ value="Sync this pair" class="button" class="button"
         onclick="this.disabled=true;this.value='Please wait...';this.form.submit();">
      </form> 
    </td>
  </tr>
  <tr>
    <td style="text-align:center;">
      <video controls="" name="media3" width="320" height="240">
        <source src="static/samples/bazigar_part1.mp4" type="video/mp4" >
      </video>
    </td>
    <td style="text-align:center;">
      <audio controls="" name="media4">
        <source src="static/samples/bazigar_part1.wav" type="audio/mpeg">
      </audio>
    </td>
    <td style="text-align:center;">
      <form action = "{{ url_for('example_fetch2') }}" method = "POST" 
         enctype = "multipart/form-data">
         <input type = "submit"/ value="Sync this pair" class="button"
         onclick="this.disabled=true;this.value='Please wait...';this.form.submit();">
      </form> 
    </td>
  </tr>
  <tr>
    <td style="text-align:center;">
      <video controls="" name="media5" width="320" height="240">
        <source src="static/samples/game.mp4" type="video/mp4">
      </video>
    </td>
    <td style="text-align:center;">
      <audio controls="" name="media6">
        <source src="static/samples/game.wav" type="audio/mpeg">
      </audio>
    </td>
    <td style="text-align:center;">
      <form action = "{{ url_for('example_fetch3') }}" method = "POST" 
         enctype = "multipart/form-data">
         <input type = "submit"/ value="Sync this pair" class="button"
         onclick="this.disabled=true;this.value='Please wait...';this.form.submit();">
      </form> 
    </td>
  </tr>
</table>
<br>

<div class="grid-x">
    <div class="cell">
        <h3>Disclaimer</h3>
        <p style="text-align: justify;">All results from this demo website or the open-source <a href="https://github.com/Rudrabha/Wav2Lip">code</a> should only be used for research/academic/personal purposes only. As the models are trained on the <a href="http://www.robots.ox.ac.uk/~vgg/data/lip_reading/lrs2.html">LRS2 dataset</a>, any form of commercial use is strictly prohibhited. Please contact us for further queries.</p>
    </div>
</div>

<div class="grid-x">
    <div class="cell">
        <h3>Ethical use</h3>
        <p style="text-align: justify;">To ensure fair use, we strongly require that any result created using this site or our code must unambiguously present itself as synthetic and that it is generated using the Wav2Lip model. In addition, to the strong positive applications of this work, our intention to completely open-source our work is that it can simultaneously also encourage efforts in detecting manipulated video content and their misuse. We believe that Wav2Lip can enable several positive applications and also encourage productive discussions and research efforts regarding fair use of synthetic content.</p>
    </div>
</div>


<script type="text/javascript">
  function submit_form(obj) {
    if (document.getElementById("aud_inp").files.length == 0){
      alert('Audio file not selected!');
      return false;
    }
    if (document.getElementById("vid_inp").files.length == 0){
      alert('Video file not selected!');
      return false;
    }
    obj.disabled=true;
    obj.value='Please wait...';
    obj.form.submit()
  }
    
</script>



{% endblock %}


